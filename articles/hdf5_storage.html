<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>HDF5 Storage Formats • scExploreR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="HDF5 Storage Formats">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">scExploreR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><h6 class="dropdown-header" data-toc-skip>Help and Tutorials</h6></li>
    <li><a class="dropdown-item" href="../articles/dataset_setup_walkthrough.html">App Setup Walkthrough</a></li>
    <li><a class="dropdown-item" href="../articles/tutorial.html">Exploring your Data</a></li>
    <li><a class="dropdown-item" href="../articles/object_guidelines.html">Object Preparation Guidelines</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Additional Information</h6></li>
    <li><a class="dropdown-item" href="../articles/scRNA_Plots_Explained.html">Guide to scRNA-Seq Plots</a></li>
    <li><a class="dropdown-item" href="../articles/advanced_subsetting_documentation.html">String Subsetting Guide</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Full Documentation</h6></li>
    <li><a class="dropdown-item" href="../articles/full_documentation.html">scExploreR Documentation</a></li>
    <li><a class="dropdown-item" href="../articles/config_documentation.html">Config App Documentation</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/amc-heme/scExploreR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>HDF5 Storage Formats</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/amc-heme/scExploreR/blob/main/vignettes/hdf5_storage.Rmd" class="external-link"><code>vignettes/hdf5_storage.Rmd</code></a></small>
      <div class="d-none name"><code>hdf5_storage.Rmd</code></div>
    </div>

    
    
<style type="text/css"> 
  .centered-image{
    display: block; 
    margin-left: auto; 
    margin-right: auto;
    } 
    </style>
<p>The size of single cell objects can make hosting in scExploreR
difficult or impossible on local computing resources. Objects can take
tens or even hundreds of gigabytes of RAM when loaded into memory,
depending on the number of cells. Fortunately, scExploreR supports
storage formats for multiple object types that require only fractions of
the data to be loaded into RAM at once, considerably decreasing the RAM
requirements. Guidelines are provided below for each common object
formats to allow the analysis of datasets with hundreds of thousands or
even millions of cells on a personal computer.</p>
<div class="section level2">
<h2 id="anndata-objects">Anndata Objects<a class="anchor" aria-label="anchor" href="#anndata-objects"></a>
</h2>
<p>Anndata is the preferred object format for HDF5 disk-based storage,
and it is the easiest to set up. To use HDF5 formatting for an Anndata
object, simply save it via the <code><a href="https://rdrr.io/r/base/write.html" class="external-link">write()</a></code> method in python. If
using the Anndata package in R, use <code>write_h5ad()</code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># adata: an Anndata object preprocessed and clustered using Scanpy</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>adata.write(filename <span class="op">=</span> <span class="st">"output_path.h5ad"</span>)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># If saving via the R anndata package</span></span>
<span><span class="fu">anndata</span><span class="fu">::</span><span class="fu">write_h5ad</span><span class="op">(</span><span class="va">adata</span>, filename <span class="op">=</span> <span class="st">"output_path.h5ad"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="seurat-objects">Seurat Objects<a class="anchor" aria-label="anchor" href="#seurat-objects"></a>
</h2>
<p>With the release of <a href="https://satijalab.org/seurat/" class="external-link">Seurat
v5</a>, Seurat objects may employ HDF5 storage via BPcells. The
differential gene expression tab can’t be used for Seurat objects with
BPcells arrays, but the plots tab can still be used.</p>
<p>Objects processed with Seurat version 5 should automatically use
BPCells-based storage. Seurat must be updated at least to version 5.0.0
to use this format.</p>
<p>Seurat v5 objects also allow the user to create a “sketch” assay with
a representative subsample of cells. The sketch assay is stored in
memory to optimize for performance, while the full assay is stored on
disk. <a href="https://satijalab.org/seurat/articles/seurat5_sketch_analysis" class="external-link">See
here</a> for more information.</p>
</div>
<div class="section level2">
<h2 id="singlecellexperiment-objects">SingleCellExperiment Objects<a class="anchor" aria-label="anchor" href="#singlecellexperiment-objects"></a>
</h2>
<p>To use HDF5 storage for SingleCellExperiment objects, save the object
using <code>saveHDF5SummarizedExperiment()</code> from the <a href="https://bioconductor.org/packages/release/bioc/html/HDF5Array.html" class="external-link">HDF5Array</a>
package.</p>
<p>The <code>level</code> parameter determines the compression level
when creating the disk-based matrices. Higher compression levels
decrease the amount of disk space used, but decrease performance. We
recommend a compression level of 3.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">saveHDF5SummarizedExperiment</span><span class="op">(</span></span>
<span>    <span class="co"># sce: SingleCellExperiment object</span></span>
<span>    <span class="va">sce</span>,</span>
<span>    dir <span class="op">=</span> <span class="st">"output_directory/"</span>,</span>
<span>    level <span class="op">=</span> <span class="fl">3</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<p>The output of saveHDF5SummarizedExperiment is a directory rather than
a single file. Make sure to reference the directory when loading the
object into scExploreR, rather than the files in the directory.</p>
</div>
<div class="section level2">
<h2 id="converting-between-object-formats">Converting Between Object Formats<a class="anchor" aria-label="anchor" href="#converting-between-object-formats"></a>
</h2>
<p>See the <a href="https://github.com/cellgeni/sceasy/tree/master" class="external-link">scEasy</a> package
for efficient means of converting between different SingleCellExperiment
object formats.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Hematology Informatics Group.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
